(()=>{"use strict";var e=document.querySelector("#card-template").content;function t(t,n,o,r){var c=e.querySelector(".card").cloneNode(!0),u=c.querySelector(".card__image"),a=c.querySelector(".card__title"),i=c.querySelector(".card__delete-button");return a.textContent=t.name,u.src=t.link,u.alt=t.name,i.addEventListener("click",(function(){n(c)})),c.addEventListener("click",o),c.addEventListener("click",r),c}function n(e){Array.from(e.target.classList).includes("card__like-button")&&function(e){e.classList.toggle("card__like-button_is-active")}(e.target)}function o(e){e.remove()}var r=document.querySelector(".page");function c(e){e.classList.add("popup_is-opened"),r.addEventListener("keydown",a)}function u(e){e.classList.remove("popup_is-opened"),r.removeEventListener("keydown",a)}function a(e){"Escape"===e.key&&u(r.querySelector(".popup_is-opened"))}var i,l=function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));/^[a-zA-Zа-яА-ЯёЁ\s-]*$/.test(t.value)||"name"!==t.name&&"place-name"!==t.name?t.setCustomValidity(""):t.setCustomValidity(t.dataset.errorMesage),t.validity.valid?d(t,n):s(t,n)},p=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove("popup__button_disabled")):(t.disabled=!0,t.classList.add("popup__button_disabled"))},s=function(e,t){e.classList.add("popup__input_type_error"),t.textContent=e.validationMessage},d=function(e,t){e.classList.remove("popup__input_type_error"),t.textContent=""},_=function(e){var t=Array.from(e.querySelectorAll(".popup__input")),n=Array.from(e.querySelectorAll(".form__input-error"));t.forEach((function(e){return e.classList.remove("popup__input_type_error")})),n.forEach((function(e){return e.textContent=""})),p(t,e.querySelector("button"))},f=document.querySelector(".profile__info"),m=f.querySelector(".profile__edit-button"),y=f.querySelector(".profile__title"),v=f.querySelector(".profile__description"),S=document.querySelector(".profile__image"),q=document.forms["edit-profile"],b=q.elements.name,h=q.elements.description,E=document.querySelector(".profile__add-button"),L=document.forms["new-place"],g=L.elements["place-name"],k=L.elements.link,C=document.querySelector(".places__list"),A=document.querySelector(".popup__image"),x=document.querySelector(".popup__caption"),w=document.querySelectorAll(".popup"),j=document.querySelector(".popup_type_edit"),z=document.querySelector(".popup_type_new-card"),B=document.querySelector(".popup_type_image"),N=document.querySelectorAll(".popup__close"),D={token:"16f0e5f5-827d-4c0b-b4a9-5f08e8999d36",cohort:"wff-cohort-9",url:"https://mesto.nomoreparties.co/v1/"};function M(e){C.append(t(e,o,n,P))}function P(e){"card__image"===e.target.className&&(A.src=e.target.src,A.alt=e.target.alt,x.textContent=e.target.alt,c(B))}m.addEventListener("click",(function(){c(j),b.value=y.textContent,h.value=v.textContent,_(q)})),E.addEventListener("click",(function(){c(z),L.reset(),_(L)})),N.forEach((function(e){e.addEventListener("click",(function(){u(e.parentElement.parentNode)}))})),w.forEach((function(e){e.classList.add("popup_is-animated"),function(e){e.addEventListener("click",(function(e){u(e.target)}))}(e)})),function(e){fetch("".concat(e.url).concat(e.cohort,"/users/me"),{headers:{authorization:e.token}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){y.textContent=e.name,v.textContent=e.about,S.style="background-image: url(".concat(e.avatar,");")})).catch((function(e){console.log("Ошибка ".concat(e))}))}(D),function(e){fetch("".concat(e.url).concat(e.cohort,"/cards"),{headers:{authorization:e.token}}).then((function(e){return e.ok?e.json():Promise.reject(e.status)})).then((function(e){e.forEach(M)})).catch((function(e){console.log("Ошибка ".concat(e))}))}(D),q.addEventListener("submit",(function(e){var t,n;e.preventDefault(),t=b,n=h,y.textContent=t.value,v.textContent=n.value,u(j)})),L.addEventListener("submit",(function(e){var r,c;e.preventDefault(),r=k,c={name:g.value,link:r.value},C.prepend(t(c,o,n,P)),u(z)})),i={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Array.from(document.querySelectorAll(i.formSelector)).forEach((function(e){!function(e,t){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);n.forEach((function(e){e.addEventListener("input",(function(){l(t,e),p(n,o)}))}))}(i,e)}))})();